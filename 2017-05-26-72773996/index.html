<!DOCTYPE html>
<html>
<head hexo-theme="https://volantis.js.org/#2.6.6">
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>[原创]华中农业大学第五届程序设计大赛 I	Candies [线段树]【数据结构】 - tabris的博客</title>
  
    <meta name="keywords" content="CSDN">
  
  
    <meta name="description" content="[原创]华中农业大学第五届程序设计大赛 I    Candies [线段树]【数据结构】
2017-05-26 22:03:13  Tabris_ 阅读数：309

博客爬取于2020-06-14 22:40:30以下为正文
版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。https://blog...">
  

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="tabris的博客">
  

  <!-- import meta -->
  
    
      <meta name="theme-color" content="#FFFFFF">
    
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  

  <!-- import link -->
  
  
  <link rel="shortcut icon" type="image/x-icon" sizes="16x16 32x32 48x48 64x64" href="/assets/favicon/favicon.ico">
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/favicon/favicon_180.png">
  <link rel="mask-icon" color="#1BC3FB" href="/assets/favicon/favicon_180.png">
  <link rel="manifest" href="/manifest.json">
  

  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">
  <div class="container">
  <div class="wrapper">
    <div class="nav-sub">
      <p class="title"></p>
      <ul class="switcher nav-list-h">
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href="javascript:void(0)"></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href="javascript:void(0)"></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href="/">
          
          
            <i class="https://cdn.jsdelivr.net/gh/tabris233/cdn-assets/avatar/avatar.jpg"></i>
          
          
            Tabris
          
          
        </a>
      

			<div class="menu navigation">
				<ul class="nav-list-h">
          
          
          
            
            
              <li>
                <a class="flat-box" href="/" id="home">
                  <i class="fas fa-home fa-fw"></i>首页
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/categories/" id="categories">
                  <i class="fas fa-folder-open fa-fw"></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/tags/" id="tags">
                  <i class="fas fa-tags fa-fw"></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/archives/" id="archives">
                  <i class="fas fa-archive fa-fw"></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/friends/" id="friends">
                  <i class="fas fa-link fa-fw"></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/about/" id="about">
                  <i class="fas fa-info-circle fa-fw"></i>关于
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box">
                  <i class="fas fa-book fa-fw"></i>待整理
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="flat-box" href="/categories/" id="categories">
                  <i class="fas fa-folder-open fa-fw"></i>分类
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/tags/" id="tags">
                  <i class="fas fa-tags fa-fw"></i>标签
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/archives/" id="archives">
                  <i class="fas fa-archive fa-fw"></i>归档
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/friends/" id="friends">
                  <i class="fas fa-link fa-fw"></i>友链
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/about/" id="about">
                  <i class="fas fa-info-circle fa-fw"></i>关于
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="搜索...">
        </form>
      </div>

			<ul class="switcher nav-list-h">
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href="javascript:void(0)"></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href="javascript:void(0)"></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="flat-box" href="/" id="home">
                  <i class="fas fa-home fa-fw"></i>首页
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/categories/" id="categories">
                  <i class="fas fa-folder-open fa-fw"></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/tags/" id="tags">
                  <i class="fas fa-tags fa-fw"></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/archives/" id="archives">
                  <i class="fas fa-archive fa-fw"></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/friends/" id="friends">
                  <i class="fas fa-link fa-fw"></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/about/" id="about">
                  <i class="fas fa-info-circle fa-fw"></i>关于
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box">
                  <i class="fas fa-book fa-fw"></i>待整理
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="flat-box" href="/categories/" id="categories">
                  <i class="fas fa-folder-open fa-fw"></i>分类
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/tags/" id="tags">
                  <i class="fas fa-tags fa-fw"></i>标签
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/archives/" id="archives">
                  <i class="fas fa-archive fa-fw"></i>归档
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/friends/" id="friends">
                  <i class="fas fa-link fa-fw"></i>友链
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/about/" id="about">
                  <i class="fas fa-info-circle fa-fw"></i>关于
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class="body-wrapper">
      

<div class="l_main">
  

  
    <article id="post" class="post white-box reveal shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class="meta">
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h1 class="title">
    <a href="/2017-05-26-72773996/">
      [原创]华中农业大学第五届程序设计大赛 I	Candies [线段树]【数据结构】
    </a>
  </h1>


        
        <div class="new-meta-box">
          
            
          
            
              
<div class="new-meta-item author">
  <a href rel="nofollow">
    <img src>
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class="new-meta-item category">
    <a href="/categories/csdn/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>CSDN/动态规划</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class="notlink">
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2017年5月26日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  <div class="new-meta-item wordcount">
    <a class="notlink">
      <i class="fas fa-keyboard fa-fw" aria-hidden="true"></i>
      <p>字数：1.2k字</p>
    </a>
  </div>
  <div class="new-meta-item readtime">
    <a class="notlink">
      <i class="fas fa-hourglass-half fa-fw" aria-hidden="true"></i>
      <p>时长：6分钟</p>
    </a>
  </div>


            
          
            
              
  <div class="new-meta-item browse valine">
    <a class="notlink">
      <i class="fas fa-eye fa-fw" aria-hidden="true"></i>
      
      <span id="/2017-05-26-72773996/" class="leancloud_visitors" data-flag-title="[原创]华中农业大学第五届程序设计大赛 I	Candies [线段树]【数据结构】">
      <p>
        <span class="leancloud-visitors-count"></span>
      </p>
      </span>
    </a>
  </div>


            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>[原创]华中农业大学第五届程序设计大赛 I    Candies [线段树]【数据结构】</p>
<p>2017-05-26 22:03:13  <a href="https://me.csdn.net/qq_33184171" target="_blank" rel="external nofollow noopener noreferrer">Tabris_</a> 阅读数：309</p>
<hr>
<p>博客爬取于<code>2020-06-14 22:40:30</code><br><strong><em>以下为正文</em></strong></p>
<p>版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。<br><a href="https://blog.csdn.net/qq_33184171/article/details/72773996" target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq_33184171/article/details/72773996</a></p>
<a id="more"></a>

<hr>
<p>题目链接:<a href="http://acm.hzau.edu.cn/problem.php?id=1207" target="_blank" rel="external nofollow noopener noreferrer">http://acm.hzau.edu.cn/problem.php?id=1207</a><br>——————————————————————————————————————<br>1207: Candies<br>Time Limit: 2 Sec  Memory Limit: 1280 MB<br>Submit: 249  Solved: 39<br>[Submit][Status][Web Board]<br>Description<br>     Xiao Ming likes those N candies he collects very much. There are two kinds of candies, A and B. One day, Xiao Ming puts his candies in a row and plays games. And he can replace the Lth candy to the Rth candy with the same kind of candies. Now, he wonder that if he eats the Lth candy to Rth candy, he can eat how many B candy continuously at most. For each Xiao Ming’s query, give the number of the B candy he can eat continuously at most. </p>
<p>Input<br>     In the first line, there is an integer T, indicates the number of test cases.</p>
<p>   For each case, there are two integers N and M in the first line, indicate the number of candies and the time of Xiao Ming’s operations.</p>
<p>   The second line is a N-length string consist of character A and B, indicates the row of candies Xiao Ming put.</p>
<p>   The next M line is Xiao Ming’s operations. There are two kind of operations:</p>
<ol>
<li><p>1 L R v, indicate Xiao Ming replaces the Lth candy to the Rth candy with A candies (v==1) or B candies ( v == 2 ).</p>
</li>
<li><p>2 L R, indicate Xiao Ming wonder that there are how many continuous B candies between the Lth candy to the Rth candy most. </p>
</li>
</ol>
<p>Output<br>       In each case, the first line is “Case #k: “, k indicates the case number.</p>
<p>   For each query, output the number of the most continuous B candies. </p>
<p>Sample Input<br>1<br>5 3<br>ABABB<br>2 1 3<br>1 2 3 2<br>2 1 3<br>Sample Output<br>Case #1:<br>1<br>2</p>
<p>————————————————————————————————————————————<br>题目大意：<br>给你一个序列，分别代表AB两种果实，</p>
<p>有两种操作，<br>1 将区间l，r 全变为（A或B）中操作<br>2 问你区间l，r 中连续的B最长是多长</p>
<p>解题思路：<br>线段树维护就好了</p>
<p>因为要有维护两个区间并的情况，所以要维护<br>sum 当前区间内连续的B的长度<br>ls     当前左边界开始向右连续B的长度<br>rs     当前右边界开始向左连续B的长度<br>lazy  懒标记</p>
<p>然后注意下维护的细节就好</p>
<p>Ps： 本来自己写了份代码，但是写到最后query的时候发现，合并时需要的信息得需要一个结构体来存诸，然而我写的时数组的。。。。。心态爆炸。。  最后厚颜无耻的贴了代码。。。</p>
<p>附本题代码<br>————————————————————————————————</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">include</span> &lt;bits/stdc++.h&gt;  </span><br><span class="line">using namespace std;  </span><br><span class="line">   </span><br><span class="line">const <span class="built_in">int</span> maxn = <span class="number">1e6</span> + <span class="number">7</span>;  </span><br><span class="line"><span class="keyword">struct</span> node&#123;  </span><br><span class="line">    <span class="built_in">int</span> l, r, <span class="keyword">lazy</span>, len;  </span><br><span class="line">    <span class="built_in">int</span> lb, mb, rb;  </span><br><span class="line">    void <span class="constructor">Set_B(<span class="params">int</span> <span class="params">key</span>)</span>&#123; <span class="comment">// 对区间内的 lb, mb, rb 进行更改  </span></span><br><span class="line">        <span class="keyword">if</span>(key<span class="operator"> == </span><span class="number">1</span>) lb = mb = rb = <span class="number">0</span>;  </span><br><span class="line">        <span class="keyword">else</span> lb = mb = rb = len;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; tree<span class="literal">[<span class="identifier">maxn</span>&lt;&lt;<span class="number">2</span>]</span>;  </span><br><span class="line"><span class="built_in">char</span> z<span class="literal">[<span class="identifier">maxn</span>]</span>;  </span><br><span class="line">   </span><br><span class="line"><span class="built_in">int</span> <span class="constructor">Find_max(<span class="params">int</span> <span class="params">s1</span>, <span class="params">int</span> <span class="params">s2</span>, <span class="params">int</span> <span class="params">s3</span>)</span>&#123;  </span><br><span class="line">    <span class="keyword">if</span>(s2 &gt; s1) s1 = s2;  </span><br><span class="line">    <span class="keyword">if</span>(s3 &gt; s1) s1 = s3;  </span><br><span class="line">    return s1;  </span><br><span class="line">&#125;  </span><br><span class="line">   </span><br><span class="line">void <span class="constructor">Push_up(<span class="params">int</span> <span class="params">key</span>)</span>&#123; <span class="comment">// 向上更新, 区间合并  </span></span><br><span class="line">    <span class="built_in">int</span> lson = key&lt;&lt;<span class="number">1</span>, rson = key&lt;&lt;<span class="number">1</span><span class="pattern-match">|1;  </span></span><br><span class="line"><span class="pattern-match">    tree[key].lb = tree[lson].lb;  </span></span><br><span class="line"><span class="pattern-match">    tree[key].rb = tree[rson].rb;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(tree[lson].lb <span class="operator">==</span> tree[lson].len) tree[key].lb += tree[rson].lb;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(tree[rson].rb <span class="operator">==</span> tree[rson].len) tree[key].rb += tree[lson].rb;  </span></span><br><span class="line"><span class="pattern-match">    tree[key].mb = max(tree[lson].rb + tree[rson].lb, max(tree[lson].mb, tree[rson].mb));  </span></span><br><span class="line"><span class="pattern-match">&#125;  </span></span><br><span class="line"><span class="pattern-match">   </span></span><br><span class="line"><span class="pattern-match">void <span class="constructor">Push_down(<span class="params">int</span> <span class="params">key</span>)</span>&#123; <span class="operator">/</span><span class="operator">/</span> 向下更新  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(tree[key].<span class="keyword">lazy</span> != 0)&#123;  </span></span><br><span class="line"><span class="pattern-match">        <span class="built_in">int</span> lson = key&lt;&lt;1, rson = key&lt;&lt;1|1;  </span></span><br><span class="line"><span class="pattern-match">        tree[lson].<span class="keyword">lazy</span> = tree[rson].<span class="keyword">lazy</span> = tree[key].<span class="keyword">lazy</span>;  </span></span><br><span class="line"><span class="pattern-match">        tree[lson].<span class="constructor">Set_B(<span class="params">tree</span>[<span class="params">key</span>].<span class="params">lazy</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">        tree[rson].<span class="constructor">Set_B(<span class="params">tree</span>[<span class="params">key</span>].<span class="params">lazy</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">        tree[key].<span class="keyword">lazy</span> = 0;  </span></span><br><span class="line"><span class="pattern-match">    &#125;  </span></span><br><span class="line"><span class="pattern-match">&#125;  </span></span><br><span class="line"><span class="pattern-match">   </span></span><br><span class="line"><span class="pattern-match">void <span class="constructor">Buildtree(<span class="params">int</span> <span class="params">l</span>, <span class="params">int</span> <span class="params">r</span>, <span class="params">int</span> <span class="params">key</span>)</span>&#123; <span class="operator">/</span><span class="operator">/</span> 建树  </span></span><br><span class="line"><span class="pattern-match">    tree[key].l = l;  </span></span><br><span class="line"><span class="pattern-match">    tree[key].r = r;  </span></span><br><span class="line"><span class="pattern-match">    tree[key].len = r - l + 1;  </span></span><br><span class="line"><span class="pattern-match">    tree[key].<span class="keyword">lazy</span> = 0;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(l <span class="operator">==</span> r)&#123;  </span></span><br><span class="line"><span class="pattern-match">        <span class="keyword">if</span>(z[l] <span class="operator">==</span> '<span class="constructor">A</span>') tree[key].<span class="constructor">Set_B(1)</span>;  </span></span><br><span class="line"><span class="pattern-match">        <span class="keyword">else</span> tree[key].<span class="constructor">Set_B(2)</span>;  </span></span><br><span class="line"><span class="pattern-match">        return;  </span></span><br><span class="line"><span class="pattern-match">    &#125;  </span></span><br><span class="line"><span class="pattern-match">    <span class="built_in">int</span> mid = (l + r) &gt;&gt; 1;  </span></span><br><span class="line"><span class="pattern-match">    <span class="constructor">Buildtree(<span class="params">l</span>, <span class="params">mid</span>, <span class="params">key</span>&lt;&lt;1)</span>;  </span></span><br><span class="line"><span class="pattern-match">    <span class="constructor">Buildtree(<span class="params">mid</span>+1, <span class="params">r</span>, <span class="params">key</span>&lt;&lt;1|1)</span>;  </span></span><br><span class="line"><span class="pattern-match">    <span class="constructor">Push_up(<span class="params">key</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">&#125;  </span></span><br><span class="line"><span class="pattern-match">   </span></span><br><span class="line"><span class="pattern-match">void <span class="constructor">Update(<span class="params">int</span> <span class="params">l</span>, <span class="params">int</span> <span class="params">r</span>, <span class="params">int</span> <span class="params">key</span>, <span class="params">int</span> <span class="params">w</span>)</span>&#123; <span class="operator">/</span><span class="operator">/</span> 更新  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(l &lt;= tree[key].l <span class="operator">&amp;&amp;</span> tree[key].r &lt;= r)&#123;  </span></span><br><span class="line"><span class="pattern-match">        tree[key].<span class="keyword">lazy</span> = w;  </span></span><br><span class="line"><span class="pattern-match">        tree[key].<span class="constructor">Set_B(<span class="params">w</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">        return;  </span></span><br><span class="line"><span class="pattern-match">    &#125;  </span></span><br><span class="line"><span class="pattern-match">    <span class="constructor">Push_down(<span class="params">key</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">    <span class="built_in">int</span> mid = (tree[key].l + tree[key].r) &gt;&gt; 1;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(l &lt;= mid) <span class="constructor">Update(<span class="params">l</span>, <span class="params">r</span>, <span class="params">key</span>&lt;&lt;1, <span class="params">w</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(mid &lt; r) <span class="constructor">Update(<span class="params">l</span>, <span class="params">r</span>, <span class="params">key</span>&lt;&lt;1|1, <span class="params">w</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">    <span class="constructor">Push_up(<span class="params">key</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">&#125;  </span></span><br><span class="line"><span class="pattern-match">   </span></span><br><span class="line"><span class="pattern-match">node <span class="constructor">Merge(<span class="params">node</span> <span class="params">p</span>, <span class="params">node</span> <span class="params">q</span>)</span>&#123; <span class="operator">/</span><span class="operator">/</span> 区间合并, 与向上更新相同  </span></span><br><span class="line"><span class="pattern-match">    node tmp;  </span></span><br><span class="line"><span class="pattern-match">    tmp.len = p.len + q.len;  </span></span><br><span class="line"><span class="pattern-match">    tmp.lb = p.lb;  </span></span><br><span class="line"><span class="pattern-match">    tmp.rb = q.rb;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(p.lb <span class="operator">==</span> p.len) tmp.lb += q.lb;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(q.rb <span class="operator">==</span> q.len) tmp.rb += p.rb;  </span></span><br><span class="line"><span class="pattern-match">    tmp.mb = max(p.rb + q.lb, max(p.mb, q.mb));  </span></span><br><span class="line"><span class="pattern-match">    return tmp;  </span></span><br><span class="line"><span class="pattern-match">&#125;  </span></span><br><span class="line"><span class="pattern-match">   </span></span><br><span class="line"><span class="pattern-match">node <span class="constructor">Query(<span class="params">int</span> <span class="params">l</span>, <span class="params">int</span> <span class="params">r</span>, <span class="params">int</span> <span class="params">key</span>)</span>&#123; <span class="operator">/</span><span class="operator">/</span> 询问  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(l &lt;= tree[key].l <span class="operator">&amp;&amp;</span> tree[key].r &lt;= r) return tree[key];  </span></span><br><span class="line"><span class="pattern-match">    <span class="constructor">Push_down(<span class="params">key</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">    <span class="built_in">int</span> mid = (tree[key].l + tree[key].r) &gt;&gt; 1;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">if</span>(r &lt;= mid) return <span class="constructor">Query(<span class="params">l</span>, <span class="params">r</span>, <span class="params">key</span>&lt;&lt;1)</span>;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">else</span> <span class="keyword">if</span>(mid &lt; l) return <span class="constructor">Query(<span class="params">l</span>, <span class="params">r</span>, <span class="params">key</span>&lt;&lt;1|1)</span>;  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">else</span> return <span class="constructor">Merge(Query(<span class="params">l</span>, <span class="params">mid</span>, <span class="params">key</span>&lt;&lt;1)</span>, <span class="constructor">Query(<span class="params">mid</span>+1, <span class="params">r</span>, <span class="params">key</span>&lt;&lt;1|1)</span>);  </span></span><br><span class="line"><span class="pattern-match">&#125;  </span></span><br><span class="line"><span class="pattern-match">   </span></span><br><span class="line"><span class="pattern-match"><span class="built_in">int</span> main()&#123;  </span></span><br><span class="line"><span class="pattern-match">    <span class="built_in">int</span> t, n, q, op, u, v, w;  </span></span><br><span class="line"><span class="pattern-match">    <span class="built_in">int</span> num = 0;  </span></span><br><span class="line"><span class="pattern-match">    scanf("%d", &amp;t);  </span></span><br><span class="line"><span class="pattern-match">    <span class="keyword">while</span>(t --)&#123;  </span></span><br><span class="line"><span class="pattern-match">        scanf("%d %d", &amp;n, &amp;q);  </span></span><br><span class="line"><span class="pattern-match">        scanf("%s", z+1);  </span></span><br><span class="line"><span class="pattern-match">        <span class="constructor">Buildtree(1, <span class="params">n</span>, 1)</span>;  </span></span><br><span class="line"><span class="pattern-match">        printf("<span class="constructor">Case</span> #%d:\n", <span class="operator">++</span> num); <span class="operator">/</span><span class="operator">/</span> 这里很坑，如果后面没有空格会<span class="constructor">WA</span>掉  </span></span><br><span class="line"><span class="pattern-match">        <span class="keyword">while</span>(q --)&#123;  </span></span><br><span class="line"><span class="pattern-match">            scanf("%d %d %d", &amp;op, &amp;u, &amp;v);  </span></span><br><span class="line"><span class="pattern-match">            <span class="keyword">if</span>(op <span class="operator">==</span> 1)&#123;  </span></span><br><span class="line"><span class="pattern-match">                scanf("%d", &amp;w);  </span></span><br><span class="line"><span class="pattern-match">                <span class="constructor">Update(<span class="params">u</span>, <span class="params">v</span>, 1, <span class="params">w</span>)</span>;  </span></span><br><span class="line"><span class="pattern-match">            &#125;  </span></span><br><span class="line"><span class="pattern-match">            <span class="keyword">else</span>&#123;  </span></span><br><span class="line"><span class="pattern-match">                node gg = <span class="constructor">Query(<span class="params">u</span>, <span class="params">v</span>, 1)</span>;  </span></span><br><span class="line"><span class="pattern-match">                printf("%d\n", <span class="constructor">Find_max(<span class="params">gg</span>.<span class="params">lb</span>, <span class="params">gg</span>.<span class="params">mb</span>, <span class="params">gg</span>.<span class="params">rb</span>)</span>);  </span></span><br><span class="line"><span class="pattern-match">            &#125;  </span></span><br><span class="line"><span class="pattern-match">        &#125;  </span></span><br><span class="line"><span class="pattern-match">    &#125;  </span></span><br><span class="line"><span class="pattern-match">    return 0;  </span></span><br><span class="line"><span class="pattern-match">&#125;</span></span><br></pre></td></tr></table></figure>

          
            <div class="article_footer">
              
                
  
    
    

<section class="widget copyright  desktop mobile">
  <div class="content">
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href="http://tabris.top/2017-05-26-72773996/">http://tabris.top/2017-05-26-72773996/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  
    
    

<section class="widget qrcode  desktop mobile">
  

  <div class="content article-entry">
    
      
        <div class="fancybox"><img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/tabris233/cdn-assets/qrcode/wechat.jpg" height="64px"></div>
      
    
      
        <div class="fancybox"><img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/tabris233/cdn-assets/qrcode/alipay.jpg" height="64px"></div>
      
    
  </div>
</section>

  


              
            </div>
          
        </div>
        
          


  <section class="meta" id="footer-meta">
    <div class="new-meta-box">
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-06-19T13:14:24+00:00">
  <a class="notlink">
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2020年6月19日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/csdn/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>CSDN</p></a></div>


        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title rel="external nofollow noopener noreferrer" href="http://connect.qq.com/widget/shareqq/index.html?url=http://tabris.top/2017-05-26-72773996/&title=[原创]华中农业大学第五届程序设计大赛 I	Candies [线段树]【数据结构】 - tabris的博客&summary=[原创]华中农业大学第五届程序设计大赛 I    Candies [线段树]【数据结构】
2017-05-26 22:03:13  Tabris_ 阅读数：309

博客爬取于2020-06-14 22:40:30以下为正文
版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。https://blog.csdn.net/qq_33184171/article/details/72773996" target="_blank">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title rel="external nofollow noopener noreferrer" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://tabris.top/2017-05-26-72773996/&title=[原创]华中农业大学第五届程序设计大赛 I	Candies [线段树]【数据结构】 - tabris的博客&summary=[原创]华中农业大学第五届程序设计大赛 I    Candies [线段树]【数据结构】
2017-05-26 22:03:13  Tabris_ 阅读数：309

博客爬取于2020-06-14 22:40:30以下为正文
版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。https://blog.csdn.net/qq_33184171/article/details/72773996" target="_blank">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title rel="external nofollow noopener noreferrer" href="http://service.weibo.com/share/share.php?url=http://tabris.top/2017-05-26-72773996/&title=[原创]华中农业大学第五届程序设计大赛 I	Candies [线段树]【数据结构】 - tabris的博客&summary=[原创]华中农业大学第五届程序设计大赛 I    Candies [线段树]【数据结构】
2017-05-26 22:03:13  Tabris_ 阅读数：309

博客爬取于2020-06-14 22:40:30以下为正文
版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。https://blog.csdn.net/qq_33184171/article/details/72773996" target="_blank">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
      
        
        <div class="hoverbox">
          <a><img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/wechat.png"></a>
          <div class="target">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAAAAACi5bZQAAAC/ElEQVR42u3ay27jQAwEQP//T2fvQQwNm1RWdGpuFqxX6dJgz+vL+nG9EIABAwYMGDBrYF7hurxB8fzvx6/u8+563fcBAwYMGDBgwOyDOQ5A4Yul4OkHSd8HDBgwYMCAAbMX5jIANQPVdABMnw8MGDBgwIABA2b6/DQ4ggEDBgwYMGDAdAPe6YCpejy9LhgwYMCAAQPm78CUC6rhNR3w/lsTCQYMGDBgwID5NZhucfa03/H7gAEDBgwYMGDWwHTXKVi6oXkqyB3fBwwYMGDAgAGzBiYNSFcvPF3cVQu36vODAQMGDBgwYPbBdDfcdEGqgbG7Uak8qAIDBgwYMGDArIGpAqSDqKvzp65b/jBgwIABAwYMmI+BOQ1i1fOqxVkK1t44BAYMGDBgwIB5PEx3IHT6gmnAKw+cwoEZGDBgwIABA2YPTHewlF6nO/iaKvTeBjwwYMCAAQMGzONhpgCm4K4GWt0NQ+3kCwYMGDBgwIB5DMx0cKsWa9WiLP2Qx/8HAwYMGDBgwKyHOT0+9b9ukVYt3N4+JxgwYMCAAQPmY2C6BdbpSgdfaUF33ESCAQMGDBgwYB4LM33h2wZIYZCLB1VgwIABAwYMmMfDvIqrOmiaKtiqA6p4EAYGDBgwYMCAWQczFcROB13VQVha8J0CggEDBgwYMGD2wkwXXlMbk6YKt2N4MGDAgAEDBsw6mPSGaUBLC7I0YB4P0sCAAQMGDBgwa2Gqq1ugTQW3bjAEAwYMGDBgwOyHmd64Uw1caeBLAx0YMGDAgAEDZi9Md53C3lWojQ/KwIABAwYMGDBrYF7hqg6S0gLvrkB4nHzBgAEDBgwYMI+HmQp01RfoFnZpwHv7GwwYMGDAgAGzFma6ACtv3PmlIq/dRIIBAwYMGDBgPg7mrsKsW6wdfwAwYMCAAQMGzJ+DuauQq36A9mALDBgwYMCAAbMWpvrAaRF3VxBMB15gwIABAwYMmL0w3Q1A6cDorgFW/EHAgAEDBgwYMGtgLDBgwIABAwbMsvUPF8fkHVq9VfIAAAAASUVORK5CYII=">
          </div>
        </div>
      
    
      
        <a class="-mob-share-telegram" title rel="external nofollow noopener noreferrer" href="https://t.me/share/url?url=http://tabris.top/2017-05-26-72773996/&text=[原创]华中农业大学第五届程序设计大赛 I	Candies [线段树]【数据结构】 - tabris的博客" target="_blank">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/telegram.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class="prev" href="/2017-05-26-72774870/">
                <p class="title"><i class="fas fa-chevron-left" aria-hidden="true"></i>[原创]华中农业大学第五届程序设计大赛 J	Color Circle</p>
                <p class="content">[原创]华中农业大学第五届程序设计大赛 J    Color Circle
2017-05-26 22:41:01  Tabris_ 阅读数：317

博客爬取于2020-06-14 22:40...</p>
              </a>
            
            
              <a class="next" href="/2017-05-26-72773955/">
                <p class="title">[原创]华中农业大学第五届程序设计大赛 H	MathematicalGame [01字典树]【字典树】<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class="content">[原创]华中农业大学第五届程序设计大赛 H    MathematicalGame [01字典树]【字典树】
2017-05-26 21:55:54  Tabris_ 阅读数：467

博客爬取...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box reveal comments shadow">
    <section class="article typo">
      <p ct><i class="fas fa-comments"></i> 评论</p>
      
      
      
      
      
      
        <section id="comments">
          <div id="valine_container" class="valine_thread">
            <i class="fas fa-cog fa-spin fa-fw fa-2x"></i>
          </div>
        </section>
      
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->

  <script>
  // https://github.com/theme-next/hexo-theme-next/blob/master/layout/_third-party/math/mathjax.swig
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.0/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    // 文章章节标题不能为 “MathJax” ，否则会报错。
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>




  <script>
    window.subData = {
      title: '[原创]华中农业大学第五届程序设计大赛 I	Candies [线段树]【数据结构】',
      tools: true
    }
  </script>


</div>
<aside class="l_side">
  
  
    
    

<section class="widget blogger shadow desktop mobile">
  <div class="content">
    
      
        <a class="avatar flat-box" href="/about/">
          <img no-lazy src="https://cdn.jsdelivr.net/gh/tabris233/cdn-assets/avatar/avatar.jpg">
        </a>
      
    
    
      <div class="text">
        
          <h2>tabris's blog</h2>
        
        
          <p>Tabris</p>

        
        
          <p><span id="jinrishici-sentence">tabris的博客</span></p>
          <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml" class="social fas fa-rss flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:tabris.dq@qq.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/tabris233" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=63035382" class="social fas fa-headphones-alt flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

  

  
    
    



  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          

  
    <meting-js theme="#1BCDFC" autoplay="false" volume="0.7" loop="all" order="list" fixed="false" list-max-height="340px" server="netease" type="playlist" id="3175833810" list-folded="true">
    </meting-js>
  


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/atom.xml" class="social fas fa-rss flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="mailto:tabris.dq@qq.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/tabris233" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=63035382" class="social fas fa-headphones-alt flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="external nofollow noopener noreferrer">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://volantis.js.org/" target="_blank" class="codename" rel="external nofollow noopener noreferrer">Volantis</a>
        作为主题，总访问量为
          <span id="busuanzi_value_site_pv"><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class="copyright">
        <p><a href="http://tabris.top">Copyright © 2017-2020 tabris</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href="javascript:void(0)"></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>


  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '8px',
        duration: '800',
        interval: '100',
        scale: '1'
      });
    });
  </script>


  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script defer src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('') {
          $('').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  



  
    
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>

  
    
<script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>

  









  
    
<script src="https://cdn.jsdelivr.net/npm/valine@1.4/dist/Valine.min.js"></script>

  
  <script>
  var GUEST_INFO = ['nick','mail','link'];
  var meta = 'nick,mail,link'.split(',').filter(function(item){
    return GUEST_INFO.indexOf(item) > -1
  });
  var REQUIRED_FIELDS = ['nick','mail','link'];
  var requiredFields = 'nick,mail'.split(',').filter(function(item){
    return REQUIRED_FIELDS.indexOf(item) > -1
  });
  var valine = new Valine();
  function emoji(path, idx, ext) {
      return path + "/" + path + "-" + idx + "." + ext;
  }
  var emojiMaps = {};
  for (var i = 1; i <= 54; i++) {
    emojiMaps['tieba-' + i] = emoji('tieba', i, 'png');
  }
  for (var i = 1; i <= 101; i++) {
    emojiMaps['qq-' + i] = emoji('qq', i, 'gif');
  }
  for (var i = 1; i <= 116; i++) {
    emojiMaps['aru-' + i] = emoji('aru', i, 'gif');
  }
  for (var i = 1; i <= 125; i++) {
    emojiMaps['twemoji-' + i] = emoji('twemoji', i, 'png');
  }
  for (var i = 1; i <= 4; i++) {
    emojiMaps['weibo-' + i] = emoji('weibo', i, 'png');
  }
  valine.init({
    el: '#valine_container',
    meta: meta,
    
    appId: "XkeYrd6r1FrJXgASPvPJa9Hp-gzGzoHsz",
    appKey: "de9Yfw8ns8xwf6S9eHOj82Wi",
    placeholder: "快来评论吧~",
    pageSize:'10',
    avatar:'robohash',
    lang:'zh-cn',
    visitor: 'true',
    highlight: 'true',
    mathJax: 'true',
    enableQQ: 'true',
    requiredFields: requiredFields,
    emojiCDN: 'https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/emoji/valine/',
    emojiMaps: emojiMaps
  })
  </script>





  
<script src="/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>






<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  function pjax_fancybox() {
    $(".article-entry").find("img").not('.inline').not('a img').each(function () { //渲染 fancybox
      var element = document.createElement("a"); // a 标签
      $(element).attr("pjax-fancybox", "");  // 过滤 pjax
      $(element).attr("href", $(this).attr("src"));
      if ($(this).attr("data-original")) {
        $(element).attr("href", $(this).attr("data-original"));
      }
      $(element).attr("data-fancybox", "images");
      var caption = "";   // 描述信息
      if ($(this).attr('alt')) {  // 标准 markdown 描述信息
        $(element).attr('data-caption', $(this).attr('alt'));
        caption = $(this).attr('alt');
      }
      var div = document.createElement("div");
      $(div).addClass("fancybox");
      $(this).wrap(div); // 最外层套 div ，其实主要作用还是 class 样式
      var span = document.createElement("span");
      $(span).addClass("image-caption");
      $(span).text(caption); // 加描述
      $(this).after(span);  // 再套一层描述
      $(this).wrap(element);  // 最后套 a 标签
    })
    $(".article-entry").find("img").fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
      closeClick: true,
      helpers: {
        overlay: {closeClick: true}
      },
      buttons: [
        "zoom",
        "close"
      ]
    });
  };
  $(function () {
    pjax_fancybox();
  });
</script>




  <script>setLoadingBarProgress(100);</script>
<script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)t=c[r],0<=(n=t.getBoundingClientRect()).bottom&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this);</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script></body>
</html>
