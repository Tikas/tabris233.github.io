<!DOCTYPE html>
<html>
<head hexo-theme="https://volantis.js.org/#2.6.6">
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】 - tabris的博客</title>
  
    <meta name="keywords" content="CSDN">
  
  
    <meta name="description" content="[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】
2016-12-28 19:13:06  Tabris_ 阅读数：264

博客爬取于2020-06-14 22:42:29以下为正文
版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。https://blog.csdn.net...">
  

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="tabris的博客">
  

  <!-- import meta -->
  
    
      <meta name="theme-color" content="#FFFFFF">
    
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13/css/all.min.css">
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css">
  

  

  <!-- import link -->
  
  
  <link rel="shortcut icon" type="image/x-icon" sizes="16x16 32x32 48x48 64x64" href="/assets/favicon/favicon.ico">
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/favicon/favicon_180.png">
  <link rel="mask-icon" color="#1BC3FB" href="/assets/favicon/favicon_180.png">
  <link rel="manifest" href="/manifest.json">
  

  
  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow blur">
  <div class="container">
  <div class="wrapper">
    <div class="nav-sub">
      <p class="title"></p>
      <ul class="switcher nav-list-h">
        <li><a class="s-comment fas fa-comments fa-fw" target="_self" href="javascript:void(0)"></a></li>
        
          <li><a class="s-toc fas fa-list fa-fw" target="_self" href="javascript:void(0)"></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="title flat-box" target="_self" href="/">
          
          
            <i class="https://cdn.jsdelivr.net/gh/tabris233/cdn-assets/avatar/avatar.jpg"></i>
          
          
            Tabris
          
          
        </a>
      

			<div class="menu navigation">
				<ul class="nav-list-h">
          
          
          
            
            
              <li>
                <a class="flat-box" href="/" id="home">
                  <i class="fas fa-home fa-fw"></i>首页
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/categories/" id="categories">
                  <i class="fas fa-folder-open fa-fw"></i>分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/tags/" id="tags">
                  <i class="fas fa-tags fa-fw"></i>标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/archives/" id="archives">
                  <i class="fas fa-archive fa-fw"></i>归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/friends/" id="friends">
                  <i class="fas fa-link fa-fw"></i>友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href="/about/" id="about">
                  <i class="fas fa-info-circle fa-fw"></i>关于
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box">
                  <i class="fas fa-book fa-fw"></i>待整理
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="flat-box" href="/categories/" id="categories">
                  <i class="fas fa-folder-open fa-fw"></i>分类
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/tags/" id="tags">
                  <i class="fas fa-tags fa-fw"></i>标签
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/archives/" id="archives">
                  <i class="fas fa-archive fa-fw"></i>归档
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/friends/" id="friends">
                  <i class="fas fa-link fa-fw"></i>友链
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/about/" id="about">
                  <i class="fas fa-info-circle fa-fw"></i>关于
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
          
				</ul>
			</div>

      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <i class="icon fas fa-search fa-fw"></i>
          <input type="text" class="input u-search-input" placeholder="搜索...">
        </form>
      </div>

			<ul class="switcher nav-list-h">
				
					<li><a class="s-search fas fa-search fa-fw" target="_self" href="javascript:void(0)"></a></li>
				
				<li>
          <a class="s-menu fas fa-bars fa-fw" target="_self" href="javascript:void(0)"></a>
          <ul class="menu-phone list-v navigation white-box">
            
              
            
              <li>
                <a class="flat-box" href="/" id="home">
                  <i class="fas fa-home fa-fw"></i>首页
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/categories/" id="categories">
                  <i class="fas fa-folder-open fa-fw"></i>分类
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/tags/" id="tags">
                  <i class="fas fa-tags fa-fw"></i>标签
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/archives/" id="archives">
                  <i class="fas fa-archive fa-fw"></i>归档
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/friends/" id="friends">
                  <i class="fas fa-link fa-fw"></i>友链
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box" href="/about/" id="about">
                  <i class="fas fa-info-circle fa-fw"></i>关于
                </a>
                
              </li>
            
          
            
              
            
              <li>
                <a class="flat-box">
                  <i class="fas fa-book fa-fw"></i>待整理
                </a>
                
                  <ul class="list-v">
                    
                      
            
              <li>
                <a class="flat-box" href="/categories/" id="categories">
                  <i class="fas fa-folder-open fa-fw"></i>分类
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/tags/" id="tags">
                  <i class="fas fa-tags fa-fw"></i>标签
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/archives/" id="archives">
                  <i class="fas fa-archive fa-fw"></i>归档
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/friends/" id="friends">
                  <i class="fas fa-link fa-fw"></i>友链
                </a>
                
              </li>
            
          
                    
                      
            
              <hr>
            
          
                    
                      
            
              <li>
                <a class="flat-box" href="/about/" id="about">
                  <i class="fas fa-info-circle fa-fw"></i>关于
                </a>
                
              </li>
            
          
                    
                  </ul>
                
              </li>
            
          
            
          </ul>
        </li>
			</ul>
		</div>
	</div>
  </div>
</header>

<script>setLoadingBarProgress(40);</script>



  <div class="l_body nocover">
    <div class="body-wrapper">
      

<div class="l_main">
  

  
    <article id="post" class="post white-box reveal shadow article-type-post" itemscope itemprop="blogPost">
      


  <section class="meta">
    
      
      
      <div class="meta" id="header-meta">
        
          
  <h1 class="title">
    <a href="/2016-12-28-53912212/">
      [原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】
    </a>
  </h1>


        
        <div class="new-meta-box">
          
            
          
            
              
<div class="new-meta-item author">
  <a href rel="nofollow">
    <img src>
    <p></p>
  </a>
</div>

            
          
            
              
  
  <div class="new-meta-item category">
    <a href="/categories/csdn/poj/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>CSDN/POJ/数据结构</p>
    </a>
  </div>


            
          
            
              <div class="new-meta-item date">
  <a class="notlink">
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2016年12月28日</p>
  </a>
</div>

            
          
            
              

            
          
            
              
  <div class="new-meta-item wordcount">
    <a class="notlink">
      <i class="fas fa-keyboard fa-fw" aria-hidden="true"></i>
      <p>字数：1.6k字</p>
    </a>
  </div>
  <div class="new-meta-item readtime">
    <a class="notlink">
      <i class="fas fa-hourglass-half fa-fw" aria-hidden="true"></i>
      <p>时长：9分钟</p>
    </a>
  </div>


            
          
            
              
  <div class="new-meta-item browse valine">
    <a class="notlink">
      <i class="fas fa-eye fa-fw" aria-hidden="true"></i>
      
      <span id="/2016-12-28-53912212/" class="leancloud_visitors" data-flag-title="[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】">
      <p>
        <span class="leancloud-visitors-count"></span>
      </p>
      </span>
    </a>
  </div>


            
          
        </div>
        
          <hr>
        
      </div>
    
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p>[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】</p>
<p>2016-12-28 19:13:06  <a href="https://me.csdn.net/qq_33184171" target="_blank" rel="external nofollow noopener noreferrer">Tabris_</a> 阅读数：264</p>
<hr>
<p>博客爬取于<code>2020-06-14 22:42:29</code><br><strong><em>以下为正文</em></strong></p>
<p>版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。<br><a href="https://blog.csdn.net/qq_33184171/article/details/53912212" target="_blank" rel="external nofollow noopener noreferrer">https://blog.csdn.net/qq_33184171/article/details/53912212</a></p>
<a id="more"></a>

<hr>
<p>题目链接:<a href="http://poj.org/problem?id=3667" target="_blank" rel="external nofollow noopener noreferrer">http://poj.org/problem?id=3667</a></p>
<p>---------------------------------------------------------------------------------.<br>Hotel<br>Time Limit: 3000MS        Memory Limit: 65536K<br>Total Submissions: 16674        Accepted: 7234<br>Description</p>
<p>The cows are journeying north to Thunder Bay in Canada to gain cultural enrichment and enjoy a vacation on the sunny shores of Lake Superior. Bessie, ever the competent travel agent, has named the Bullmoose Hotel on famed Cumberland Street as their vacation residence. This immense hotel has N (1 ≤ N ≤ 50,000) rooms all located on the same side of an extremely long hallway (all the better to see the lake, of course).</p>
<p>The cows and other visitors arrive in groups of size Di (1 ≤ Di ≤ N) and approach the front desk to check in. Each group i requests a set of Di contiguous rooms from Canmuu, the moose staffing the counter. He assigns them some set of consecutive room numbers r..r+Di-1 if they are available or, if no contiguous set of rooms is available, politely suggests alternate lodging. Canmuu always chooses the value of r to be the smallest possible.</p>
<p>Visitors also depart the hotel from groups of contiguous rooms. Checkout i has the parameters Xi and Di which specify the vacating of rooms Xi ..Xi +Di-1 (1 ≤ Xi ≤ N-Di+1). Some (or all) of those rooms might be empty before the checkout.</p>
<p>Your job is to assist Canmuu by processing M (1 ≤ M &lt; 50,000) checkin/checkout requests. The hotel is initially unoccupied.</p>
<p>Input</p>
<ul>
<li>Line 1: Two space-separated integers: N and M</li>
<li>Lines 2..M+1: Line i+1 contains request expressed as one of two possible formats: (a) Two space separated integers representing a check-in request: 1 and Di (b) Three space-separated integers representing a check-out: 2, Xi, and Di</li>
</ul>
<p>Output</p>
<ul>
<li>Lines 1.....: For each check-in request, output a single line with a single integer r, the first room in the contiguous sequence of rooms to be occupied. If the request cannot be satisfied, output 0.</li>
</ul>
<p>Sample Input</p>
<p>10 6<br>1 3<br>1 3<br>1 3<br>1 3<br>2 5 5<br>1 6<br>Sample Output</p>
<p>1<br>4<br>7<br>0<br>5<br>Source</p>
<p>USACO 2008 February Gold<br>--------------------------------------------------------------------------------.</p>
<p>题目大意:<br>就是在$[1,n]$这个区间.<br>有两种操作</p>
<p>1) x    问你有没有连续x个的空房,有的话就在最左面的住进去,输出最左边的房间号,没有的话就输出0;<br>2) a b 就是从a开始接下来的b个房间的人退房  也就是$[a,a+b-1]$这个区间的房间都退房了.</p>
<p>解题思路:<br>还是基本的想到了线段树的区间更新.<br>不一样的就是这次要查找的是连续的x个长度,<br>这点想了好久,最后还是想到在节点上增加两个值,来代表区间中最左边有多少个连续的,最右边代表有多少个连续的,原本的值来代表区间内最大的连续的长度是多少.然后维护一下就行了.</p>
<p>思路构建的很容易 ,但是最后代码实现的时候发现好麻烦啊,因为一个rr写成了ll 硬是调试了2个小时有没有啊........</p>
<p>跟普通的区间更新差别也就是在pushup和pushdown两个操作上面.<br><strong>pushup</strong></p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">维护左右的最大值,</span></span><br><span class="line"><span class="comment">在维护区间内的最大值就好了</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">void pushup(int rt)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">tree</span>[ll].ls == <span class="keyword">tree</span>[ll].len())</span><br><span class="line">        <span class="keyword">tree</span>[rt].ls = <span class="keyword">tree</span>[ll].len() + <span class="keyword">tree</span>[rr].ls;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">tree</span>[rt].ls = <span class="keyword">tree</span>[ll].ls;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">tree</span>[rr].rs == <span class="keyword">tree</span>[rr].len())</span><br><span class="line">        <span class="keyword">tree</span>[rt].rs = <span class="keyword">tree</span>[rr].len() + <span class="keyword">tree</span>[ll].rs;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">tree</span>[rt].rs = <span class="keyword">tree</span>[rr].rs;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">tree</span>[rt].val = max(<span class="keyword">tree</span>[ll].rs + <span class="keyword">tree</span>[rr].ls,max(<span class="keyword">tree</span>[rr].val,<span class="keyword">tree</span>[ll].val));</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>pushdown</strong></p>
<figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">这时候</span><br><span class="line">0代表入房</span><br><span class="line">1代表退房</span><br><span class="line">维护的时候直接tree<span class="comment">[ll]</span>.len()*tree<span class="comment">[rt]</span>.lazy;就好了 方便  代码还短一点.</span><br><span class="line">*/</span><br><span class="line">void pushdown(int rt)&#123;</span><br><span class="line">    if(tree<span class="comment">[rt]</span>.lazy != -1)&#123;</span><br><span class="line">        tree<span class="comment">[ll]</span>.lazy = tree<span class="comment">[rr]</span>.lazy = tree<span class="comment">[rt]</span>.lazy;</span><br><span class="line">        tree<span class="comment">[ll]</span>.val  = tree<span class="comment">[ll]</span>.ls   = tree<span class="comment">[ll]</span>.rs = tree<span class="comment">[ll]</span>.len()*tree<span class="comment">[rt]</span>.lazy;</span><br><span class="line">        tree<span class="comment">[rr]</span>.val  = tree<span class="comment">[rr]</span>.ls   = tree<span class="comment">[rr]</span>.rs = tree<span class="comment">[rr]</span>.len()*tree<span class="comment">[rt]</span>.lazy;</span><br><span class="line">        tree<span class="comment">[rt]</span>.val  = tree<span class="comment">[rt]</span>.ls   = tree<span class="comment">[rt]</span>.rs = tree<span class="comment">[rt]</span>.len()*tree<span class="comment">[rt]</span>.lazy;</span><br><span class="line">        tree<span class="comment">[rt]</span>.lazy = -1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>附本题代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line"># include &lt;stdio.h&gt;</span><br><span class="line"># include &lt;iostream&gt;</span><br><span class="line"># include &lt;algorithm&gt;</span><br><span class="line"># include &lt;string.h&gt;</span><br><span class="line"># include &lt;math.h&gt;</span><br><span class="line"># include &lt;vector&gt;</span><br><span class="line"># include &lt;map&gt;</span><br><span class="line"># include &lt;queue&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line"># define INF        (~(1&lt;&lt;31))</span><br><span class="line"># define INFLL      (~(1ll&lt;&lt;63))</span><br><span class="line"># define pb         push_back</span><br><span class="line"># define mp         make_pair</span><br><span class="line"># define abs(a)     ((a)&gt;0?(a):-(a))</span><br><span class="line"># define lalal      puts(&quot;*******&quot;);</span><br><span class="line"># define s1(x)      scanf(&quot;%d&quot;,&amp;x)</span><br><span class="line"># define Rep(a,b,c) for(int a&#x3D;(b);a&lt;&#x3D;(c);a++)</span><br><span class="line"># define Per(a,b,c) for(int a&#x3D;(b);a&gt;&#x3D;(c);a--)</span><br><span class="line"># define no         puts(&quot;NO&quot;)</span><br><span class="line"></span><br><span class="line">typedef long long int LL ;</span><br><span class="line">typedef unsigned long long int uLL ;</span><br><span class="line"></span><br><span class="line">const int    MOD &#x3D; 1e9+7;</span><br><span class="line">const int    N   &#x3D; 50000+5;</span><br><span class="line">const double eps &#x3D; 1e-6;</span><br><span class="line">const double PI  &#x3D; acos(-1.0);</span><br><span class="line"></span><br><span class="line">&#x2F;***********************************************************************&#x2F;</span><br><span class="line"></span><br><span class="line">struct node &#123;</span><br><span class="line">    int l,r;</span><br><span class="line">    int val;</span><br><span class="line">    int ls,rs;</span><br><span class="line">    int lazy;</span><br><span class="line">    int md()&#123;return (l+r)&gt;&gt;1;&#125;</span><br><span class="line">    int len()&#123;return (r-l+1);&#125;</span><br><span class="line">&#125;tree[N&lt;&lt;2];</span><br><span class="line"></span><br><span class="line"># define ll  (rt&lt;&lt;1)</span><br><span class="line"># define rr  (rt&lt;&lt;1|1)</span><br><span class="line"># define mid (tree[rt].md())</span><br><span class="line"></span><br><span class="line">void pushup(int rt)&#123;</span><br><span class="line"></span><br><span class="line">    if(tree[ll].ls &#x3D;&#x3D; tree[ll].len())</span><br><span class="line">        tree[rt].ls &#x3D; tree[ll].len() + tree[rr].ls;</span><br><span class="line">    else tree[rt].ls &#x3D; tree[ll].ls;</span><br><span class="line"></span><br><span class="line">    if(tree[rr].rs &#x3D;&#x3D; tree[rr].len())</span><br><span class="line">        tree[rt].rs &#x3D; tree[rr].len() + tree[ll].rs;</span><br><span class="line">    else tree[rt].rs &#x3D; tree[rr].rs;</span><br><span class="line"></span><br><span class="line">    tree[rt].val &#x3D; max(tree[ll].rs + tree[rr].ls,max(tree[rr].val,tree[ll].val));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void build(int rt,int l,int r)&#123;</span><br><span class="line">    tree[rt].l  &#x3D;l,tree[rt].r&#x3D;r,tree[rt].lazy&#x3D;-1;</span><br><span class="line">    tree[rt].val&#x3D;tree[rt].ls&#x3D;tree[rt].rs&#x3D;tree[rt].len();</span><br><span class="line">    if(l&#x3D;&#x3D;r) return ;</span><br><span class="line">    build(ll,l,mid);</span><br><span class="line">    build(rr,mid+1,r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void pushdown(int rt)&#123;</span><br><span class="line">    if(tree[rt].lazy !&#x3D; -1)&#123;</span><br><span class="line">        tree[ll].lazy &#x3D; tree[rr].lazy &#x3D; tree[rt].lazy;</span><br><span class="line">        tree[ll].val  &#x3D; tree[ll].ls   &#x3D; tree[ll].rs &#x3D; tree[ll].len()*tree[rt].lazy;</span><br><span class="line">        tree[rr].val  &#x3D; tree[rr].ls   &#x3D; tree[rr].rs &#x3D; tree[rr].len()*tree[rt].lazy;</span><br><span class="line">        tree[rt].val  &#x3D; tree[rt].ls   &#x3D; tree[rt].rs &#x3D; tree[rt].len()*tree[rt].lazy;</span><br><span class="line">        tree[rt].lazy &#x3D; -1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void update(int rt,int L,int R,int op)&#123;  &#x2F;&#x2F;update 就是将 所有的 [a,a+b-1] 清一下</span><br><span class="line">    if(L&lt;&#x3D;tree[rt].l&amp;&amp;tree[rt].r&lt;&#x3D;R)&#123;</span><br><span class="line">        if(1 &#x3D;&#x3D; op)&#123; &#x2F;&#x2F;入住</span><br><span class="line">            tree[rt].val &#x3D; tree[rt].ls   &#x3D; tree[rt].rs &#x3D; 0;</span><br><span class="line">            tree[rt].lazy &#x3D; 0;</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;  &#x2F;&#x2F;退房</span><br><span class="line">            tree[rt].val  &#x3D; tree[rt].ls   &#x3D; tree[rt].rs &#x3D; tree[rt].len();</span><br><span class="line">            tree[rt].lazy &#x3D; 1;</span><br><span class="line">        &#125;</span><br><span class="line">        return ;</span><br><span class="line">    &#125;</span><br><span class="line">    pushdown(rt);</span><br><span class="line">    if(L&lt;&#x3D;mid) update(ll,L,R,op);</span><br><span class="line">    if(R&gt; mid) update(rr,L,R,op);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int query(int rt,int val)&#123;</span><br><span class="line"></span><br><span class="line">    if(tree[rt].l&#x3D;&#x3D;tree[rt].r)&#123;</span><br><span class="line">        if(val &#x3D;&#x3D; tree[rt].val) return tree[rt].l;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pushdown(rt);</span><br><span class="line">    if(tree[ll].val&gt;&#x3D;val)</span><br><span class="line">        return query(ll,val);</span><br><span class="line">    else if(tree[rr].ls+tree[ll].rs &gt;&#x3D; val)</span><br><span class="line">        return tree[ll].r-tree[ll].rs+1;</span><br><span class="line">    else if(tree[rr].val &gt;&#x3D; val)</span><br><span class="line">        return query(rr,val);</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    int n,m;</span><br><span class="line">    int op,a,b;</span><br><span class="line">    while(~s1(n))&#123;</span><br><span class="line">        s1(m);</span><br><span class="line">        build(1,1,n);</span><br><span class="line">        Rep(i,1,m)&#123;</span><br><span class="line">            s1(op);</span><br><span class="line">            if(1&#x3D;&#x3D;op)&#123;</span><br><span class="line">                s1(a);</span><br><span class="line">                int tem &#x3D; query(1,a);</span><br><span class="line">                if(tem)   update(1,tem,a+tem-1,op);</span><br><span class="line">                printf(&quot;%d\n&quot;,tem);</span><br><span class="line">            &#125;</span><br><span class="line">            else &#123;</span><br><span class="line">                s1(a),s1(b);</span><br><span class="line">                update(1,a,a+b-1,op);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
            <div class="article_footer">
              
                
  
    
    

<section class="widget copyright  desktop mobile">
  <div class="content">
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href="http://tabris.top/2016-12-28-53912212/">http://tabris.top/2016-12-28-53912212/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  

  
    
    

<section class="widget qrcode  desktop mobile">
  

  <div class="content article-entry">
    
      
        <div class="fancybox"><img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/tabris233/cdn-assets/qrcode/wechat.jpg" height="64px"></div>
      
    
      
        <div class="fancybox"><img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/tabris233/cdn-assets/qrcode/alipay.jpg" height="64px"></div>
      
    
  </div>
</section>

  


              
            </div>
          
        </div>
        
          


  <section class="meta" id="footer-meta">
    <div class="new-meta-box">
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-06-19T13:14:24+00:00">
  <a class="notlink">
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2020年6月19日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/csdn/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>CSDN</p></a></div>


        
      
        
          

        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title rel="external nofollow noopener noreferrer" href="http://connect.qq.com/widget/shareqq/index.html?url=http://tabris.top/2016-12-28-53912212/&title=[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】 - tabris的博客&summary=[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】
2016-12-28 19:13:06  Tabris_ 阅读数：264

博客爬取于2020-06-14 22:42:29以下为正文
版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。https://blog.csdn.net/qq_33184171/article/details/53912212" target="_blank">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title rel="external nofollow noopener noreferrer" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://tabris.top/2016-12-28-53912212/&title=[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】 - tabris的博客&summary=[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】
2016-12-28 19:13:06  Tabris_ 阅读数：264

博客爬取于2020-06-14 22:42:29以下为正文
版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。https://blog.csdn.net/qq_33184171/article/details/53912212" target="_blank">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title rel="external nofollow noopener noreferrer" href="http://service.weibo.com/share/share.php?url=http://tabris.top/2016-12-28-53912212/&title=[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】 - tabris的博客&summary=[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】
2016-12-28 19:13:06  Tabris_ 阅读数：264

博客爬取于2020-06-14 22:42:29以下为正文
版权声明：本文为Tabris原创文章，未经博主允许不得私自转载。https://blog.csdn.net/qq_33184171/article/details/53912212" target="_blank">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
      
        
        <div class="hoverbox">
          <a><img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/wechat.png"></a>
          <div class="target">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYCAAAAACi5bZQAAADAklEQVR42u3aQVLDMAwF0N7/0rBnYGJ9KW1VnpeQxvHz5o+kx5f163ogAAMGDBgwYNbAPMJ1ucGP565+/9fzV++/2qd6HjBgwIABAwbMPpjjAHR4sKuDnIJ3L6R8gWDAgAEDBgyYtTCXAaj4fPV36e/HzgMGDBgwYMCA+bcwaQErfR4MGDBgwIABA2YaphrYuo02MGDAgAEDBgyYqYGgdLBnOuC9rBMJBgwYMGDAgHkaTHVNF5LuLkwdnwcMGDBgwIABswamu9IGWreAVQ1yx+cBAwYMGDBgwKyBSQPSNODUoFL3+8GAAQMGDBgw+2CqAzengWwqAJ4WzFIwMGDAgAEDBsw+mLRAVAVJ9+u+t3wxYMCAAQMGDJj1MNXCVHXQqFrwSsGqBSswYMCAAQMGzB6Y6QA33ZibuoDjCwYDBgwYMGDArIE53Th9rh24ikExhQUDBgwYMGDA7INpv+jww7qFqe7A0PHfwYABAwYMGDDrYNLCUnqQaiMtBY8Hh8CAAQMGDBgwbw+TBr20YVYtXJ020tKG22UFDwwYMGDAgAHztjDdxln1gMcfGF5AGxQMGDBgwIABsxZm6oOnGnXpgW+v4IEBAwYMGDBgXg4zVTBKC1vVA6YQx0ETDBgwYMCAAbMWZmyDmxp41SA63okEAwYMGDBgwLwNTHqwqSDX3bf7fjBgwIABAwbM58OcFoa6haxuw6x7AWDAgAEDBgyYvTBxgSdsyH0drqkBp/JEFRgwYMCAAQNmHUy1AVYdMOoOAp2+p1xIAwMGDBgwYMCsgemuFGSqoTZ+kWDAgAEDBgyYNTCPcKUNurThNh0Ij5MvGDBgwIABA+btYaqB7hSg20CrBsjxgAcGDBgwYMCAWQOTBqhuoystcD29EwkGDBgwYMCA+TiY6cLXdJB7WcADAwYMGDBgwKyDSQeF0oCXDjI9PeCBAQMGDBgwYG6DqTbcTv8/VfiaCnhgwIABAwYMmM+BSQtL1YNUG2d3Dx6BAQMGDBgwYPbCWGDAgAEDBgyYZesbL+Nhyin3xQoAAAAASUVORK5CYII=">
          </div>
        </div>
      
    
      
        <a class="-mob-share-telegram" title rel="external nofollow noopener noreferrer" href="https://t.me/share/url?url=http://tabris.top/2016-12-28-53912212/&text=[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】 - tabris的博客" target="_blank">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/placeholder/c617bfd2497fcea598e621413e315c368f8d8e.svg" data-original="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/telegram.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class="prev" href="/2016-12-31-53949605/">
                <p class="title"><i class="fas fa-chevron-left" aria-hidden="true"></i>[原创]算是年末总结吧。</p>
                <p class="content">[原创]算是年末总结吧。
2016-12-31 03:54:03  Tabris_ 阅读数：620

博客爬取于2020-06-14 22:42:28以下为正文
版权声明：本文为Tabris原创...</p>
              </a>
            
            
              <a class="next" href="/2016-12-09-53541831/">
                <p class="title">[原创]POJ 1436 Horizontally Visible Segments [线段树-区间更新]【数据结构】<i class="fas fa-chevron-right" aria-hidden="true"></i></p>
                <p class="content">[原创]POJ 1436 Horizontally Visible Segments [线段树-区间更新]【数据结构】
2016-12-09 17:08:59  Tabris_ 阅读数：233
...</p>
              </a>
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box reveal comments shadow">
    <section class="article typo">
      <p ct><i class="fas fa-comments"></i> 评论</p>
      
      
      
      
      
      
        <section id="comments">
          <div id="valine_container" class="valine_thread">
            <i class="fas fa-cog fa-spin fa-fw fa-2x"></i>
          </div>
        </section>
      
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->

  <script>
  // https://github.com/theme-next/hexo-theme-next/blob/master/layout/_third-party/math/mathjax.swig
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.0/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    // 文章章节标题不能为 “MathJax” ，否则会报错。
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>




  <script>
    window.subData = {
      title: '[原创]POJ 3667 Hotel [线段树+区间更新]【数据结构】',
      tools: true
    }
  </script>


</div>
<aside class="l_side">
  
  
    
    

<section class="widget blogger shadow desktop mobile">
  <div class="content">
    
      
        <a class="avatar flat-box" href="/about/">
          <img no-lazy src="https://cdn.jsdelivr.net/gh/tabris233/cdn-assets/avatar/avatar.jpg">
        </a>
      
    
    
      <div class="text">
        
          <h2>tabris's blog</h2>
        
        
          <p>Tabris</p>

        
        
          <p><span id="jinrishici-sentence">tabris的博客</span></p>
          <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml" class="social fas fa-rss flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:tabris.dq@qq.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/tabris233" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://music.163.com/#/user/home?id=63035382" class="social fas fa-headphones-alt flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

  

  
    
    



  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <div class="aplayer-container">
          

  
    <meting-js theme="#1BCDFC" autoplay="false" volume="0.7" loop="all" order="list" fixed="false" list-max-height="340px" server="netease" type="playlist" id="3175833810" list-folded="true">
    </meting-js>
  


        </div>
      
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/atom.xml" class="social fas fa-rss flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="mailto:tabris.dq@qq.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/tabris233" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://music.163.com/#/user/home?id=63035382" class="social fas fa-headphones-alt flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="external nofollow noopener noreferrer">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://volantis.js.org/" target="_blank" class="codename" rel="external nofollow noopener noreferrer">Volantis</a>
        作为主题，总访问量为
          <span id="busuanzi_value_site_pv"><i class="fas fa-circle-notch fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class="copyright">
        <p><a href="http://tabris.top">Copyright © 2017-2020 tabris</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href="javascript:void(0)"></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>


  <script src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.6/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      ScrollReveal().reveal('.l_main .reveal', {
        distance: '8px',
        duration: '800',
        interval: '100',
        scale: '1'
      });
    });
  </script>


  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script defer src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('') {
          $('').backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "20000",
            fade: "1500"
          });
        }
      });
    </script>
  



  
    
<script src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script>

  
    
<script src="https://cdn.jsdelivr.net/npm/meting@2.0/dist/Meting.min.js"></script>

  









  
    
<script src="https://cdn.jsdelivr.net/npm/valine@1.4/dist/Valine.min.js"></script>

  
  <script>
  var GUEST_INFO = ['nick','mail','link'];
  var meta = 'nick,mail,link'.split(',').filter(function(item){
    return GUEST_INFO.indexOf(item) > -1
  });
  var REQUIRED_FIELDS = ['nick','mail','link'];
  var requiredFields = 'nick,mail'.split(',').filter(function(item){
    return REQUIRED_FIELDS.indexOf(item) > -1
  });
  var valine = new Valine();
  function emoji(path, idx, ext) {
      return path + "/" + path + "-" + idx + "." + ext;
  }
  var emojiMaps = {};
  for (var i = 1; i <= 54; i++) {
    emojiMaps['tieba-' + i] = emoji('tieba', i, 'png');
  }
  for (var i = 1; i <= 101; i++) {
    emojiMaps['qq-' + i] = emoji('qq', i, 'gif');
  }
  for (var i = 1; i <= 116; i++) {
    emojiMaps['aru-' + i] = emoji('aru', i, 'gif');
  }
  for (var i = 1; i <= 125; i++) {
    emojiMaps['twemoji-' + i] = emoji('twemoji', i, 'png');
  }
  for (var i = 1; i <= 4; i++) {
    emojiMaps['weibo-' + i] = emoji('weibo', i, 'png');
  }
  valine.init({
    el: '#valine_container',
    meta: meta,
    
    appId: "XkeYrd6r1FrJXgASPvPJa9Hp-gzGzoHsz",
    appKey: "de9Yfw8ns8xwf6S9eHOj82Wi",
    placeholder: "快来评论吧~",
    pageSize:'10',
    avatar:'robohash',
    lang:'zh-cn',
    visitor: 'true',
    highlight: 'true',
    mathJax: 'true',
    enableQQ: 'true',
    requiredFields: requiredFields,
    emojiCDN: 'https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/emoji/valine/',
    emojiMaps: emojiMaps
  })
  </script>





  
<script src="/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.6.5/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>






<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-check-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-check-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-times-circle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('fa-times-circle');
          $icon.addClass('fa-copy');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  function pjax_fancybox() {
    $(".article-entry").find("img").not('.inline').not('a img').each(function () { //渲染 fancybox
      var element = document.createElement("a"); // a 标签
      $(element).attr("pjax-fancybox", "");  // 过滤 pjax
      $(element).attr("href", $(this).attr("src"));
      if ($(this).attr("data-original")) {
        $(element).attr("href", $(this).attr("data-original"));
      }
      $(element).attr("data-fancybox", "images");
      var caption = "";   // 描述信息
      if ($(this).attr('alt')) {  // 标准 markdown 描述信息
        $(element).attr('data-caption', $(this).attr('alt'));
        caption = $(this).attr('alt');
      }
      var div = document.createElement("div");
      $(div).addClass("fancybox");
      $(this).wrap(div); // 最外层套 div ，其实主要作用还是 class 样式
      var span = document.createElement("span");
      $(span).addClass("image-caption");
      $(span).text(caption); // 加描述
      $(this).after(span);  // 再套一层描述
      $(this).wrap(element);  // 最后套 a 标签
    })
    $(".article-entry").find("img").fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
      closeClick: true,
      helpers: {
        overlay: {closeClick: true}
      },
      buttons: [
        "zoom",
        "close"
      ]
    });
  };
  $(function () {
    pjax_fancybox();
  });
</script>




  <script>setLoadingBarProgress(100);</script>
<script>!function(e){var c=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function i(){for(var r=0;r<c.length;r++)t=c[r],0<=(n=t.getBoundingClientRect()).bottom&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=c[r];t=o,n=function(){c=c.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}i(),e.addEventListener("scroll",function(){var t,n;t=i,n=e,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)})}(this);</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script></body>
</html>
